<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head('Товары - Админка')">
    <style>
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
<header th:replace="fragments/header :: header"></header>

<div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin: 2rem 0 1rem;">
        <h1>Управление товарами</h1>
        <a th:href="@{/admin/products/create}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Добавить товар
        </a>
    </div>
    
    <div th:if="${param.success}" class="alert alert-success">
        <i class="fas fa-check-circle"></i> Изменения сохранены успешно
    </div>
    
    <!-- Таблица товаров -->
    <div style="background: white; border-radius: 0.5rem; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <table style="width: 100%;">
            <thead>
                <tr style="background-color: #f9fafb;">
                    <th style="padding: 1rem; text-align: left;">ID</th>
                    <th style="padding: 1rem; text-align: left;">Изображение</th>
                    <th style="padding: 1rem; text-align: left;">Название</th>
                    <th style="padding: 1rem; text-align: left;">Категория</th>
                    <th style="padding: 1rem; text-align: left;">Цена</th>
                    <th style="padding: 1rem; text-align: left;">Количество</th>
                    <th style="padding: 1rem; text-align: left;">Действия</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="product : ${products}" style="border-bottom: 1px solid #e5e7eb;">
                    <td style="padding: 1rem;" th:text="${product.id}"></td>
                    <td style="padding: 1rem;">
                        <img th:src="${product.imageUrl != null && !product.imageUrl.isEmpty()} ? 
                              ${product.imageUrl} : '/images/default-product.jpg'" 
                             style="width: 50px; height: 50px; object-fit: contein; border-radius: 0.375rem;">
                    </td>
                    <td style="padding: 1rem;">
                        <strong th:text="${product.name}"></strong>
                        <div style="font-size: 0.875rem; color: #6b7280;" th:text="${product.description}"></div>
                    </td>
                    <td style="padding: 1rem;" th:text="${product.category?.name}"></td>
                    <td style="padding: 1rem;" th:text="${#numbers.formatDecimal(product.price, 1, 2)} + ' руб.'"></td>
                    <td style="padding: 1rem;">
                        <span th:class="${product.quantity < 10} ? 'badge badge-warning' : 'badge badge-success'"
                              th:text="${product.quantity}"></span>
                    </td>
                    <td style="padding: 1rem;">
                        <div class="action-buttons">
                            <a th:href="@{/admin/products/{id}(id=${product.id})}" class="btn btn-sm" title="Просмотр">
                                <i class="fas fa-eye"></i>
                            </a>     
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<footer th:replace="fragments/footer :: footer"></footer>
</body>
</html>